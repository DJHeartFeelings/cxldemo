	唐明宗在位的时候，他手下有两员大将，一个是他儿子李从珂，一个是他的女婿、河东节度使石敬瑭。两个人都骁勇善战，但又互不服气。到了李从珂做了后唐皇帝（就是唐末帝）以后，两人终于闹到公开破裂的地步。
		李从珂派了几万人马攻打石敬瑭所在的晋阳城。石敬瑭抵挡不了，晋阳十分危急。有个谋士桑维翰给他出个主意，要他向契丹人讨救兵。
		那时候，耶律阿保机已经死去，他的儿子耶律德光接替了契丹国主的位子。桑维翰帮石敬瑭起草了一封求救信给耶律德光，表示愿意拜契丹国主做父亲，并且答应在打退唐军之后，把雁门关以北的燕云十六州（又称幽云十六州，指幽州、云州等十六个州，都在今河北、山西两省北部）土地献给契丹。
		石敬瑭的投降活动遭到他的部将的反对。部将刘知远说：“您向契丹求救，称臣还说得过去，拜他做父亲未免过份；再说，答应给他们一些金银财宝还不要紧，不该割让土地。”
		石敬瑭一心想保住自己的利益，哪儿肯听刘知远的劝阻，急急忙忙派桑维翰带了这些卖国条件去见耶律德光。
		耶律德光本来想向南扩张土地，听到石敬瑭提出这样优厚的条件，真是喜出望外，立刻派出五万精锐骑兵去救晋阳。
		石敬瑭从晋阳城出兵夹击，把唐军打得大败。
		耶律德光来到晋阳，石敬瑭亲自出城迎接，卑躬屈膝地把比他小十岁的耶律德光称做父亲，还请教契丹兵为什么这样快就能打败唐军。耶律德光得意洋洋地吹了一通，石敬瑭马上表示十分钦佩，捧得耶律德光满心欢喜。
		耶律德光经过一番观察，觉得石敬瑭的确是死心塌地投靠他，就对石敬瑭说：“我奔波三千里，来救你们，总算有个收获。我看你的外貌和气度，够得上做个中原的主人，我就封你做皇帝吧！”
		石敬瑭还假惺惺推辞，经部下一劝说，就高兴地接受了。契丹国主正式宣布石敬瑭为皇帝。石敬瑭称帝后，立刻按照原来答应的条件，把燕云十六州割让给契丹。
		石敬瑭依靠契丹的支持，带兵南下攻打洛阳。唐末帝李从珂接连打了几次败仗，被契丹的声势吓破了胆，意志消沉，成天边喝酒边哭泣，等待灭亡，哪儿还有反抗的勇气。石敬瑭的兵还没进洛阳，唐末帝已经在宫里烧起一把火，带着一家老少投在火里自杀了。
		石敬瑭攻下洛阳，灭了后梁，正式做了中原的皇帝，国号叫晋，建都汴。这就是后晋高祖。石敬瑭对契丹国主耶律德光感恩戴德，向契丹上奏章，把契丹国主称做“父皇帝”，自己称“儿皇帝”。除了每年向契丹进贡帛三十万匹外，逢年过节，还派使者向契丹国主、太后、贵族大臣送礼。那些人一不满意，就派人责备石敬瑭，石敬瑭总是恭恭敬敬，赔礼请罪。晋朝使者到了契丹，契丹官员傲气十足，说了许多侮辱性的话。使者受了气，回到汴京，把这些事传了开去。朝廷上下都觉得丢脸，只有石敬瑭毫不在乎。
		石敬瑭靠契丹的保护，做了七年可耻的儿皇帝，病死了。他的侄儿石重贵即位，就是晋出帝。晋出帝向契丹国主上奏章的时候，自称孙儿，不称臣。耶律德光就认为对他不敬，带兵进犯。
		契丹两次进犯中原，在晋朝军民的奋力抵抗下，遭到惨重失败。但是到了最后，由于汉奸的出卖，契丹兵打进汴京，晋出帝当了俘虏，被押送到契丹。后晋就灭亡了。
		公元９４７年，耶律德光进了汴京，自称大辽皇帝（这一年契丹改国号为辽）。京城百姓听到辽兵进城，纷纷逃难。辽主耶律德光登上城楼，派人用汉语宣布说：“大家别怕，我也是人嘛。我本来并不想来，是汉人引我们进来的。我一定会让你们的生活过得更好些。”
		话虽然这样说，但是做的又是一套。他纵容辽兵以牧马为名，到处抢劫财物，叫做“打草谷”，闹得汴京、洛阳附近几百里地方，成了没有人烟的“白地”。他又命令晋国官员搜刮钱帛，不论官员百姓，都要献出钱帛“劳军”。
		中原的百姓受不了辽兵的残杀抢掠，纷纷组织义军，反抗辽兵。少的几千，多的几万。他们攻打州县，杀死辽国派出的官员。东方的起义军声势浩大，攻下了三个州。耶律德光害怕了，跟左右侍从说：“想不到中原人这样不容易对付。”过了一段时期，他把晋朝官员召集起来，宣布说：“天气热了，我在这里住不惯，要回到上国（指辽国）去看望太后了。”
		辽兵被迫退出中原。但是，被石敬瑭出卖的燕云十六州仍旧被契丹贵族占领，成为后来他们进攻中原的基地。 